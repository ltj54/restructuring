import{r as n,a as g,g as x,j as e,L as h}from"./index-Cmmb0GeE.js";import{u as w,t as b,F as f,T as p}from"./types-BP40N_3a.js";import{C as k}from"./Card-0ce4mDTe.js";import{B as j}from"./Button-DJLBmBW8.js";import{r as y}from"./authSchemas-BK_hke1i.js";function S(){const[d,r]=n.useState(null),[l,i]=n.useState(null),[c,o]=n.useState(!1),a=w({resolver:b(y),defaultValues:{email:"",password:"",repeatPassword:""},mode:"onTouched"});n.useEffect(()=>{let t=!0;return(async()=>{try{const s=await fetch(`${g}/hello`);if(!t)return;s.ok&&i(await s.text())}catch{t&&i(null)}})(),()=>{t=!1}},[]);const m=n.useMemo(()=>a.handleSubmit(async t=>{r(null),o(!0);try{const s=await fetch(`${g}/auth/register`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:t.email,password:t.password})}),u=await s.json().catch(()=>({}));if(!s.ok){r({variant:"error",message:typeof u.message=="string"?u.message:"Noe gikk galt ved registrering."});return}r({variant:"success",message:"Bruker registrert! Du kan n√• logge inn."}),a.reset({email:"",password:"",repeatPassword:""})}catch(s){r({variant:"error",message:x(s,"Kunne ikke koble til serveren.")})}finally{o(!1)}}),[a]);return{form:a,feedback:d,apiMessage:l,isSubmitting:c,onSubmit:m}}function C(){var m,t,s;const{form:d,feedback:r,apiMessage:l,isSubmitting:i,onSubmit:c}=S(),{register:o,formState:{errors:a}}=d;return e.jsx("div",{className:"w-full max-w-md mx-auto px-4 py-10",children:e.jsxs(k,{title:"Registrer deg",children:[l&&e.jsx(f,{variant:"info",message:l}),r&&e.jsx(f,{variant:r.variant,message:r.message,action:r.action}),e.jsxs("form",{onSubmit:c,className:"flex flex-col gap-5 mt-4",children:[e.jsx(p,{type:"email",label:"E-post",placeholder:"E-post",autoComplete:"email",error:(m=a.email)==null?void 0:m.message,...o("email")}),e.jsx(p,{type:"password",label:"Passord",placeholder:"Passord",autoComplete:"new-password",error:(t=a.password)==null?void 0:t.message,...o("password")}),e.jsx(p,{type:"password",label:"Bekreft passord",placeholder:"Bekreft passord",autoComplete:"new-password",error:(s=a.repeatPassword)==null?void 0:s.message,...o("repeatPassword")}),e.jsx(j,{type:"submit",disabled:i,children:i?"Registrerer...":"Registrer"})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-slate-600",children:["Har du allerede en konto?"," ",e.jsx(h,{to:"/login",className:"text-brand-dark font-medium hover:underline",children:"Logg inn her"}),"."]})]})})}export{C as default};
