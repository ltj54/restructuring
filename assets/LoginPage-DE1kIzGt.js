import{a as p,r as d,u as x,i as h,g as k,c as b,j as e,L as u}from"./index-BVVrAzlo.js";import{u as v,t as j,F as w,T as g}from"./types-Dj17ZYS3.js";import{C as y}from"./Card-c8NqY-G7.js";import{B as S}from"./Button-UvbmjkVq.js";import{l as L}from"./authSchemas-NTkf77mk.js";import{P as N}from"./PageLayout-DNITwTV4.js";function E(){const a=p(),s=d.useMemo(()=>a.state?.from,[a.state?.from]),{login:o,isAuthenticating:l}=x(),[n,r]=d.useState(null),i=v({resolver:j(L),defaultValues:{email:"",password:""},mode:"onTouched"}),m=d.useMemo(()=>i.handleSubmit(async c=>{r(null);try{await o({email:c.email,password:c.password},{redirectTo:s||"/plan"})}catch(t){if(h(t)){if(t.status===401){r({variant:"error",message:"Ugyldig e-post eller passord."});return}if(t.status===404){r({variant:"error",message:"Brukeren finnes ikke.",action:{type:"link",to:"/register",label:"Registrer deg her."}});return}if(t.status>=500){r({variant:"error",message:"Kunne ikke logge inn. Brukeren finnes kanskje ikke, eller det oppstod en teknisk feil.",action:{type:"link",to:"/register",label:"Opprett bruker"}});return}}r({variant:"error",message:k(t,"Innlogging feilet.")})}}),[i,o,s]);return{form:i,feedback:n,isSubmitting:l,onSubmit:m}}function M(){const{form:a,feedback:s,isSubmitting:o,onSubmit:l}=E(),{register:n,formState:{errors:r}}=a,i=p(),m=b(),t=new URLSearchParams(i.search).get("redirect")||"/insurance";return e.jsx(N,{title:"Logg inn",subtitle:"GÃ¥ videre til plan, veiviser og dekninger.",maxWidthClassName:"max-w-xl",children:e.jsxs(y,{children:[s&&e.jsx(w,{variant:s.variant,message:s.message,action:s.action}),e.jsxs("form",{onSubmit:a.handleSubmit(async f=>{await l(f)&&m(t,{replace:!0})}),className:"flex flex-col gap-5 mt-4",children:[e.jsx(g,{type:"email",label:"E-post",placeholder:"E-post",autoComplete:"email",error:r.email?.message,...n("email")}),e.jsx(g,{type:"password",label:"Passord",placeholder:"Passord",autoComplete:"current-password",error:r.password?.message,...n("password")}),e.jsx(S,{type:"submit",disabled:o,children:o?"Logger inn...":"Logg inn"}),e.jsx("div",{className:"text-center",children:e.jsx(u,{to:"/forgot-password",className:"text-sm text-slate-600 hover:text-brand-dark hover:underline",children:"Glemt passord?"})})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-slate-600",children:["Har du ikke konto?"," ",e.jsx(u,{to:"/register",className:"text-brand-dark font-medium hover:underline",children:"Registrer deg her"}),"."]})]})})}export{M as default};
