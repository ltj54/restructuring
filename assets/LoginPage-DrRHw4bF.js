import{a as x,r as u,u as b,i as v,g as k,c as j,j as e,L as p}from"./index-ChOPYuWW.js";import{u as w,t as y,F as S,T as f}from"./types-DZkPKePd.js";import{C as L}from"./Card-DNUO8PFY.js";import{B as N}from"./Button-DQhS-srs.js";import{l as P}from"./authSchemas-B9QLRdyR.js";import{P as E}from"./PageLayout-BG43K2Qo.js";function F(){var d;const o=x(),t=u.useMemo(()=>{var a;return(a=o.state)==null?void 0:a.from},[(d=o.state)==null?void 0:d.from]),{login:i,isAuthenticating:m}=b(),[l,s]=u.useState(null),n=w({resolver:y(P),defaultValues:{email:"",password:""},mode:"onTouched"}),c=u.useMemo(()=>n.handleSubmit(async a=>{s(null);try{await i({email:a.email,password:a.password},{redirectTo:t||void 0})}catch(r){if(v(r)){if(r.status===401){s({variant:"error",message:"Ugyldig e-post eller passord."});return}if(r.status===404){s({variant:"error",message:"Brukeren finnes ikke.",action:{type:"link",to:"/register",label:"Registrer deg her."}});return}if(r.status>=500){s({variant:"error",message:"Det oppstod en teknisk feil. Prøv igjen senere."});return}}s({variant:"error",message:k(r,"Innlogging feilet.")})}}),[n,i,t]);return{form:n,feedback:l,isSubmitting:m,onSubmit:c}}function G(){var r,g;const{form:o,feedback:t,isSubmitting:i,onSubmit:m}=F(),{register:l,formState:{errors:s}}=o,n=x(),c=j(),a=new URLSearchParams(n.search).get("redirect")||"/insurance";return e.jsx(E,{title:"Logg inn",subtitle:"Gå videre til plan, veiviser og dekninger.",maxWidthClassName:"max-w-xl",children:e.jsxs(L,{children:[t&&e.jsx(S,{variant:t.variant,message:t.message,action:t.action}),e.jsxs("form",{onSubmit:o.handleSubmit(async h=>{await m(h)&&c(a,{replace:!0})}),className:"flex flex-col gap-5 mt-4",children:[e.jsx(f,{type:"email",label:"E-post",placeholder:"E-post",autoComplete:"email",error:(r=s.email)==null?void 0:r.message,...l("email")}),e.jsx(f,{type:"password",label:"Passord",placeholder:"Passord",autoComplete:"current-password",error:(g=s.password)==null?void 0:g.message,...l("password")}),e.jsx(N,{type:"submit",disabled:i,children:i?"Logger inn...":"Logg inn"}),e.jsx("div",{className:"text-center",children:e.jsx(p,{to:"/forgot-password",className:"text-sm text-slate-600 hover:text-brand-dark hover:underline",children:"Glemt passord?"})})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-slate-600",children:["Har du ikke konto?"," ",e.jsx(p,{to:"/register",className:"text-brand-dark font-medium hover:underline",children:"Registrer deg her"}),"."]})]})})}export{G as default};
