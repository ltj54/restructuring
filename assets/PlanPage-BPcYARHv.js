import{b as E,u as B,r as l,f as v,j as e,L as y}from"./index-Cc9AxI-F.js";import{C as R}from"./Card-DVoLZtiO.js";import{B as N}from"./Button-B9LAz19B.js";import{P as O}from"./PageLayout-BMlKevA8.js";const S={"Før omstilling":{title:"Før omstilling - bygg trygghet tidlig",description:"Du er i en tidlig fase. Målet nå er å skaffe oversikt og forberede deg uten å skape unødig stress.",bullets:["Skriv ned hva som bekymrer deg konkret - ikke bare «omstilling generelt».","Finn ut hvem som faktisk vet hva (leder, HR, tillitsvalgt).","Sjekk hvilke forsikringer og ordninger du allerede har via jobb eller fagforening."]},"Under omstilling":{title:"Under omstilling - ta kontroll på endringene",description:"Endringene er i gang. Her handler planen om å beholde oversikt og bruke rettighetene dine aktivt.",bullets:["Sørg for skriftlig informasjon om forslagene som gjelder deg.","Be om et konkret møte om din rolle og dine alternativer.","Lag et enkelt regneark med «nå» og «etter omstilling» for lønn og arbeidstid."]},"Etter omstilling":{title:"Etter omstilling - juster økonomi og kurs",description:"Omstillingen er gjennomført. Planen flyttes nå over på økonomi, videre karriere og hva som skal være neste steg for deg.",bullets:["Oppdater budsjett med reell inntekt og kostnader etter omstilling.","Lag en konkret 3-måneders plan for kompetanse, CV og søknader.","Vurder behov for ekstra inntektssikring hvis inntekten er mer usikker enn før."]}};function M(){const w=E(),{isAuthenticated:c}=B(),P=new URLSearchParams(w.search).get("phase")??"",[s,D]=l.useState(null),[g,x]=l.useState({}),[a,h]=l.useState(""),[b,u]=l.useState(null),[L,m]=l.useState(!1),[f,p]=l.useState(!1),[k,j]=l.useState(null),i=P||(s==null?void 0:s.fase)||"",n=i?S[i]:void 0,A=a||i;l.useEffect(()=>{c&&(m(!0),(async()=>{try{const t=await v("/plan/me");if(!t){m(!1);return}const o=t.phase?{persona:t.persona??"Annet",fase:t.phase,behov:t.needs??[],createdAt:t.createdAt??new Date().toISOString()}:null;D(o);const r={...t.diaries??{}};if(t.phase&&t.diary&&!r[t.phase]&&(r[t.phase]=t.diary),x(r),t.diary&&u(t.updatedAt??t.createdAt??null),!a){const d=i||t.phase||"Før omstilling";h(d)}}catch{}finally{m(!1)}})())},[c,a,i]);const F=t=>{const o=t.target.value;j(null),a&&(x(r=>({...r,[a]:o})),c&&(p(!0),(async()=>{try{const r=new Date().toISOString();await v("/plan/me",{method:"PUT",body:{persona:(s==null?void 0:s.persona)??"Annet",phase:a||(s==null?void 0:s.fase)||i,needs:(s==null?void 0:s.behov)??[],diary:o}}),u(r)}catch{j("Kunne ikke lagre endringen nå.")}finally{p(!1)}})()))},C=e.jsxs(e.Fragment,{children:[e.jsx(N,{to:"/wizard",className:"bg-gradient-to-r from-emerald-400 to-teal-500 text-slate-900 border-transparent font-semibold",children:"Start veiviseren"}),e.jsx(N,{to:"/resources",className:"bg-white text-emerald-700 border-emerald-200 hover:bg-emerald-50 font-semibold",children:"Se ressurser"})]});return e.jsx(O,{title:"Min plan",subtitle:"Fire steg som gir deg oversikt: fase, økonomi, kompetanse og konkrete handlinger. Alt lagres på brukeren din.",actions:C,maxWidthClassName:"max-w-5xl",children:e.jsxs(R,{children:[L&&e.jsx("p",{className:"mb-3 text-xs text-slate-500",children:"Laster plan ..."}),s?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-white p-4 text-sm",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{children:[e.jsx("b",{children:"Rolle:"})," ",s.persona]}),e.jsxs("div",{children:[e.jsx("b",{children:"Fase:"})," ",A||s.fase]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("b",{children:"Behov:"})," ",s.behov.join(", ")||"-"]})]}),e.jsxs("div",{className:"text-slate-500 mt-2 text-xs",children:["Laget: ",new Date(s.createdAt).toLocaleString()]})]}),n&&e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-4 text-sm",children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-slate-900 mb-1",children:n.title}),e.jsx("p",{className:"text-sm text-slate-700 mb-3",children:n.description}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-slate-700",children:n.bullets.map(t=>e.jsx("li",{children:t},t))})]})]}):e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-4 text-sm",children:["Ingen plan funnet."," ",e.jsx(y,{to:"/wizard",className:"text-emerald-700 font-medium underline",children:"Start veiviser"}),"."]}),n&&e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-4 text-sm",children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-slate-900 mb-1",children:n.title}),e.jsx("p",{className:"text-sm text-slate-700 mb-3",children:n.description}),e.jsx("ul",{className:"list-disc list-inside space-y-1 text-sm text-slate-700",children:n.bullets.map(t=>e.jsx("li",{children:t},t))})]})]}),e.jsxs("section",{className:"mt-6 rounded-2xl border border-slate-200 bg-white p-4 text-sm",children:[e.jsxs("div",{className:"flex items-center justify-between gap-2 mb-2",children:[e.jsx("h2",{className:"text-base md:text-lg font-semibold text-slate-900",children:"Dagbok for denne fasen"}),b&&!f&&e.jsxs("span",{className:"text-xs text-slate-500",children:["Lagret"," ",new Date(b).toLocaleString(void 0,{dateStyle:"short",timeStyle:"short"})]})]}),e.jsx("p",{className:"text-xs text-slate-600 mb-3",children:"Skriv korte notater om møter, avtaler og ting du vil følge opp. Notatene lagres på denne brukeren."}),e.jsx("div",{className:"mb-3 flex flex-wrap gap-2",children:Object.keys(S).map(t=>{var d;const o=!!((d=g[t])!=null&&d.trim()),r=a===t;return e.jsxs("button",{type:"button",onClick:()=>h(t),className:`px-3 py-1 rounded-full text-xs border flex items-center gap-1 ${r?"bg-slate-900 text-white border-slate-900":"bg-white text-slate-700 border-slate-300"}`,children:[e.jsx("span",{children:t}),o&&e.jsx("span",{"aria-hidden":"true",className:r?"inline-block w-1.5 h-1.5 rounded-full bg-white/90":"inline-block w-1.5 h-1.5 rounded-full bg-emerald-500"})]},t)})}),e.jsx("textarea",{value:a&&g[a]||"",onChange:F,rows:8,className:"w-full rounded-xl border border-slate-300 bg-white p-3 text-sm shadow-sm focus:outline-none focus:ring-2 focus:ring-emerald-200 resize-y",placeholder:"F.eks. hva ble sagt på siste møte, hva du vil spørre om neste gang, eller hvordan situasjonen påvirker deg nå."}),f&&e.jsx("p",{className:"mt-1 text-xs text-slate-500",children:"Lagrer ..."}),k&&e.jsx("p",{className:"mt-1 text-xs text-red-500",children:k})]}),e.jsx("h2",{className:"mt-6 text-lg font-semibold text-slate-900",children:"Handlinger (14 dager)"}),e.jsx("ul",{className:"mt-3 space-y-2",children:["Skaff formell oversikt (datoer, møter, referat).","Lag et enkelt budsjett og identifiser buffer.","Oppdater CV + 3 jobbsøknader eller interne muligheter.","Book en samtale med rådgiver/mentor."].map(t=>e.jsx("li",{className:"rounded-2xl border border-slate-200 bg-slate-50 p-3 text-sm",children:t},t))}),e.jsx("div",{className:"mt-6",children:e.jsx(y,{to:"/resources",className:"block rounded-xl border border-slate-200 bg-white py-3 text-center text-sm font-semibold hover:bg-slate-50",children:"Ressurser"})})]})})}export{M as default};
