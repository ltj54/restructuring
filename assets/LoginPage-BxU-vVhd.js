import{a as p,r as d,u as x,i as h,g as b,c as v,j as e,L as u}from"./index-IST0QHVW.js";import{u as k,t as j,F as w,T as g}from"./types-CUtUjmsB.js";import{C as y}from"./Card-BoiwNR6c.js";import{B as S}from"./Button-BIXv3_rL.js";import{l as L}from"./authSchemas-Cwv3-339.js";import{P as N}from"./PageLayout-BE_FrvBE.js";function P(){const a=p(),r=d.useMemo(()=>a.state?.from,[a.state?.from]),{login:o,isAuthenticating:l}=x(),[n,s]=d.useState(null),i=k({resolver:j(L),defaultValues:{email:"",password:""},mode:"onTouched"}),m=d.useMemo(()=>i.handleSubmit(async c=>{s(null);try{await o({email:c.email,password:c.password},{redirectTo:r||void 0})}catch(t){if(h(t)){if(t.status===401){s({variant:"error",message:"Ugyldig e-post eller passord."});return}if(t.status===404){s({variant:"error",message:"Brukeren finnes ikke.",action:{type:"link",to:"/register",label:"Registrer deg her."}});return}if(t.status>=500){s({variant:"error",message:"Det oppstod en teknisk feil. Prøv igjen senere."});return}}s({variant:"error",message:b(t,"Innlogging feilet.")})}}),[i,o,r]);return{form:i,feedback:n,isSubmitting:l,onSubmit:m}}function M(){const{form:a,feedback:r,isSubmitting:o,onSubmit:l}=P(),{register:n,formState:{errors:s}}=a,i=p(),m=v(),t=new URLSearchParams(i.search).get("redirect")||"/insurance";return e.jsx(N,{title:"Logg inn",subtitle:"Gå videre til plan, veiviser og dekninger.",maxWidthClassName:"max-w-xl",children:e.jsxs(y,{children:[r&&e.jsx(w,{variant:r.variant,message:r.message,action:r.action}),e.jsxs("form",{onSubmit:a.handleSubmit(async f=>{await l(f)&&m(t,{replace:!0})}),className:"flex flex-col gap-5 mt-4",children:[e.jsx(g,{type:"email",label:"E-post",placeholder:"E-post",autoComplete:"email",error:s.email?.message,...n("email")}),e.jsx(g,{type:"password",label:"Passord",placeholder:"Passord",autoComplete:"current-password",error:s.password?.message,...n("password")}),e.jsx(S,{type:"submit",disabled:o,children:o?"Logger inn...":"Logg inn"}),e.jsx("div",{className:"text-center",children:e.jsx(u,{to:"/forgot-password",className:"text-sm text-slate-600 hover:text-brand-dark hover:underline",children:"Glemt passord?"})})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-slate-600",children:["Har du ikke konto?"," ",e.jsx(u,{to:"/register",className:"text-brand-dark font-medium hover:underline",children:"Registrer deg her"}),"."]})]})})}export{M as default};
