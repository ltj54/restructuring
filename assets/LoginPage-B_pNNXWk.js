import{b as f,r as c,u as x,i as h,g as b,j as e,L as u}from"./index-BsvHFTIB.js";import{u as k,t as v,F as j,T as p}from"./types-DdQNjdUv.js";import{C as w}from"./Card-D5Ffn74t.js";import{B as L}from"./Button-D7PdnU9M.js";import{l as y}from"./authSchemas-BOiX-g2r.js";import{P as S}from"./PageLayout-DNKVmLvP.js";function E(){var g;const n=f(),s=c.useMemo(()=>{var o;return(o=n.state)==null?void 0:o.from},[(g=n.state)==null?void 0:g.from]),{login:a,isAuthenticating:d}=x(),[l,r]=c.useState(null),t=k({resolver:v(y),defaultValues:{email:"",password:""},mode:"onTouched"}),m=c.useMemo(()=>t.handleSubmit(async o=>{r(null);try{await a({email:o.email,password:o.password},{redirectTo:s||void 0})}catch(i){if(h(i)){if(i.status===401){r({variant:"error",message:"Ugyldig e-post eller passord."});return}if(i.status===404){r({variant:"error",message:"Brukeren finnes ikke.",action:{type:"link",to:"/register",label:"Registrer deg her."}});return}if(i.status>=500){r({variant:"error",message:"Det oppstod en teknisk feil. Prøv igjen senere."});return}}r({variant:"error",message:b(i,"Innlogging feilet.")})}}),[t,a,s]);return{form:t,feedback:l,isSubmitting:d,onSubmit:m}}function B(){var t,m;const{form:n,feedback:s,isSubmitting:a,onSubmit:d}=E(),{register:l,formState:{errors:r}}=n;return e.jsx(S,{title:"Logg inn",subtitle:"Gå videre til plan, veiviser og dekninger.",maxWidthClassName:"max-w-xl",children:e.jsxs(w,{children:[s&&e.jsx(j,{variant:s.variant,message:s.message,action:s.action}),e.jsxs("form",{onSubmit:d,className:"flex flex-col gap-5 mt-4",children:[e.jsx(p,{type:"email",label:"E-post",placeholder:"E-post",autoComplete:"email",error:(t=r.email)==null?void 0:t.message,...l("email")}),e.jsx(p,{type:"password",label:"Passord",placeholder:"Passord",autoComplete:"current-password",error:(m=r.password)==null?void 0:m.message,...l("password")}),e.jsx(L,{type:"submit",disabled:a,children:a?"Logger inn...":"Logg inn"}),e.jsx("div",{className:"text-center",children:e.jsx(u,{to:"/forgot-password",className:"text-sm text-slate-600 hover:text-brand-dark hover:underline",children:"Glemt passord?"})})]}),e.jsxs("p",{className:"mt-6 text-center text-sm text-slate-600",children:["Har du ikke konto?"," ",e.jsx(u,{to:"/register",className:"text-brand-dark font-medium hover:underline",children:"Registrer deg her"}),"."]})]})})}export{B as default};
